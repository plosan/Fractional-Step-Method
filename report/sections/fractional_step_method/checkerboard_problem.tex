\subsection{The checkerboard problem}

Notice that \eqref{eq:velocity_time_n+1_fsm_first_approach} is a vector equation, hence expanding it by components gives:
\begin{equation} \label{eq:velocity_checkerboard_problem}
    \left\{
        \begin{aligned}
            u^{n+1} &= u^p - \frac{\Delta t}{\rho} p_x^{n+1} \\
            v^{n+1} &= v^p - \frac{\Delta t}{\rho} p_y^{n+1} \\
            w^{n+1} &= w^p - \frac{\Delta t}{\rho} p_z^{n+1} \\
        \end{aligned}
    \right.
\end{equation}
Consider the discretization of the $x$--component of \eqref{eq:velocity_checkerboard_problem}:
\begin{equation}
    u_P^{n+1} = 
    u_P^p - \frac{\Delta t}{\rho} 
    \left( \frac{p_E^{n+1} - p_W^{n+1}}{2 \, \Delta x} \right)
\end{equation}
Notice that the discrete approximation of $\grad{p}^{n+1}$ is independent of $p_P^{n+1}$.

\begin{figure}[h]
    \centering
    \begin{tikzpicture}
        \def\side{2cm}
        \def\ys{0.5cm}
        \def\ofset{0.1cm}
        \def\arrowlength{0.75cm}
        % Control volume
        \fill[cvfill] (0,0) rectangle (3*\side,\side);
        \draw[wall] (0,0) rectangle (3*\side,\side);
        \draw[wall] (\side,0) -- ++(0,\side);
        \draw[wall] (2*\side,0) -- ++(0,\side);
        % Node W
        \draw[velocity] (0.5*\side,0.5*\side) -- node[midway, below]{$u_W^{n+1}$} ++(\arrowlength,0);
        \filldraw[black] (0.5*\side,0.5*\side) circle (2pt);
        \node[black, yshift=+\ys] at (0.5*\side,0.5*\side) {$p_W^{n+1}$};
        % Node P
        \draw[velocity] (1.5*\side,0.5*\side) -- node[midway, below]{$u_P^{n+1}$} ++(\arrowlength,0);
        \filldraw[black] (1.5*\side,0.5*\side) circle (2pt);
        \node[black, yshift=+\ys] at (1.5*\side,0.5*\side) {$p_P^{n+1}$};
        % Node E
        \draw[velocity] (2.5*\side,0.5*\side) -- node[midway, below]{$u_E^{n+1}$} ++(\arrowlength,0);
        \filldraw[black] (2.5*\side,0.5*\side) circle (2pt);
        \node[black, yshift=+\ys] at (2.5*\side,0.5*\side) {$p_E^{n+1}$};
        % Measuring line
        \draw[measureline] (0.5*\side,-0.5*\side) -- node[above]{$\Delta x$} ++(\side,0);
        \draw[measureline] (1.5*\side,-0.5*\side) -- node[above]{$\Delta x$} ++(\side,0);
        \draw[measureaux, yshift=-\ofset] (0.5*\side,-0.5*\side) -- ++(0,0.5*\side);
        \draw[measureaux, yshift=-\ofset] (1.5*\side,-0.5*\side) -- ++(0,0.5*\side);
        \draw[measureaux, yshift=-\ofset] (2.5*\side,-0.5*\side) -- ++(0,0.5*\side);
    \end{tikzpicture}
\end{figure}


\begin{figure}[h]
    \centering
    \begin{tikzpicture}
        \def\side{2cm}
        \def\ys{0.5cm}
        \def\ofset{0.1cm}
        \def\arrowlength{0.75cm}
        % Control volumes
        \fill[cvfill] (0,0) rectangle (5*\side,\side);
        \draw[wall] (0,0) rectangle (5*\side,\side);
        \draw[wall] (\side,0) -- ++(0,\side);
        \draw[wall] (2*\side,0) -- ++(0,\side);
        \draw[wall] (3*\side,0) -- ++(0,\side);
        \draw[wall] (4*\side,0) -- ++(0,\side);



        % Node WW
        \begin{scope}[shift={(0.5*\side, 0.5*\side)}]
            \draw[velocity] (0,0) -- node[midway, below]{$u_{WW}^{n+1}$} ++(\arrowlength,0);
            \filldraw[black] (0,0) circle (2pt);
            \node[black, yshift=+\ys] at (0,0) {$p_{WW}^{n+1}$};
        \end{scope}

        
        % Node P
        \draw[velocity] (1.5*\side,0.5*\side) -- node[midway, below]{$u_P^{n+1}$} ++(\arrowlength,0);
        \filldraw[black] (1.5*\side,0.5*\side) circle (2pt);
        \node[black, yshift=+\ys] at (1.5*\side,0.5*\side) {$p_P^{n+1}$};
        % Node E
        \draw[velocity] (2.5*\side,0.5*\side) -- node[midway, below]{$u_E^{n+1}$} ++(\arrowlength,0);
        \filldraw[black] (2.5*\side,0.5*\side) circle (2pt);
        \node[black, yshift=+\ys] at (2.5*\side,0.5*\side) {$p_E^{n+1}$};
    \end{tikzpicture}
\end{figure}